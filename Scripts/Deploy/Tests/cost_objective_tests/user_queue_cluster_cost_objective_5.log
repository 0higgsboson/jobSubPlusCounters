16/07/14 07:26:27 INFO mapreduce.Job: 


 ********** Custom MR Client From Sherpa
16/07/14 07:26:27 INFO mapreduce.Job: **************************************************** 



Tag=NA	 PSManaged=true	 Cost_Obj=	 Queue Name: default
16/07/14 07:26:27 INFO utils.ClassUtils: Class Path: org/apache/hadoop/examples/WordCount$TokenizerMapper.class
16/07/14 07:26:27 INFO utils.ClassUtils: Class Path: org/apache/hadoop/examples/WordCount$IntSumReducer.class
16/07/14 07:26:27 INFO utils.ClassUtils: Class Path: org/apache/hadoop/examples/WordCount$IntSumReducer.class
Workload ID:9e9a510e2ca0f47309faa7b7f0ef96ff230ec6f5
Tag=NA	 PSManaged=true	 Cost_Obj=	 Queue Name: default
Setting User & Queue ...
Looking up user's queues ...
Queues Found: root	default	
Queue: defaultUser Name: root	 Queue Name: default
16/07/14 07:26:30 INFO utils.SystemPropertiesLoader: Loading Properties from: /opt/sherpa.properties
16/07/14 07:26:30 INFO utils.SystemPropertiesLoader: System Properties loaded from defined path ...
16/07/14 07:26:30 INFO utils.SystemPropertiesLoader: Properties: {cluster.id=sherpa, jobhistoryserver.externalprogrampath=/root/fetchurl.py, tenzing.hostname=SherpaDevVM, clientagent.heartbeat.max.extrawait.sec=10, clientagent.heartbeat.faliure.count=1, tenzing.port=80, tomcat.version=8.0.35, hadoop.version=2.7.1, clientagent.port=2552, tenzing.basepath=/opt/sherpa/Tenzing/, jobhistoryserver.externalprogramname=python, clientagent.message.retry.time=20, clientagent.message.delivery.attempts=3, db.mongo.port=27017, clientagent.sync.retry.time=10, clientagent.nontunedjobinterval=0, jobhistoryserver.useexternalprogram=yes, client.agent.hostname=SherpaDevVM, db.mongo.host=localhost, clientagent.heartbeat.interval.mins=100000, tomcat.install.dir=/opt/tomcat/, clientagent.basepath=/opt/sherpa/ClientAgent/}

Web Proxy: Connecting to CA for tuned params ...
Using CA Provided Cost Objective: Latency
Tuned job=true
Tuned Parameters: {java.heap.size.map=68, mapreduce.map.sort.spill.percent=0.7755352881620485, mapreduce.reduce.shuffle.parallelcopies=2, mapreduce.reduce.shuffle.merge.percent=0.8835523203152067, mapreduce.task.io.sort.mb=54, mapreduce.reduce.cpu.vcores=2, mapreduce.reduce.input.buffer.percent=0.09096555132230605, mapreduce.map.cpu.vcores=1, java.heap.size.reduce=80, mapreduce.map.memory.mb=2042, mapreduce.reduce.shuffle.input.buffer.percent=0.7476920427309443, mapreduce.reduce.merge.inmem.threshold=7104, mapreduce.job.reduce.slowstart.completedmaps=0.07662748502428685, mapreduce.tasktracker.indexcache.mb=5, mapreduce.reduce.memory.mb=350, mapreduce.job.reduces=23, mapreduce.max.split.size=239399212}
No configuration value found for configuration: java.heap.size.map
No configuration value found for configuration: java.heap.size.reduce
No configuration value found for configuration: mapreduce.max.split.size
Default Parameters: {java.heap.size.map=, mapreduce.map.sort.spill.percent=0.80, mapreduce.reduce.shuffle.parallelcopies=5, mapreduce.reduce.shuffle.merge.percent=0.66, mapreduce.task.io.sort.mb=100, mapreduce.reduce.cpu.vcores=1, mapreduce.reduce.input.buffer.percent=0.0, mapreduce.map.cpu.vcores=1, java.heap.size.reduce=, mapreduce.map.memory.mb=1024, mapreduce.reduce.shuffle.input.buffer.percent=0.70, mapreduce.reduce.merge.inmem.threshold=1000, mapreduce.job.reduce.slowstart.completedmaps=0.05, mapreduce.tasktracker.indexcache.mb=10, mapreduce.reduce.memory.mb=1024, mapreduce.job.reduces=1, mapreduce.max.split.size=}
Setting Heap Sizes: (Map=68, Reduce=80)

(Map Memory=2042, Map Heap Size=1388)
(Reduce Memory=350, Reduce Heap Size=280)16/07/14 07:26:31 INFO impl.TimelineClientImpl: Timeline service address: http://SherpaDevVM:8188/ws/v1/timeline/
16/07/14 07:26:31 INFO client.RMProxy: Connecting to ResourceManager at SherpaDevVM/127.0.1.1:8032
16/07/14 07:26:31 INFO client.AHSProxy: Connecting to Application History server at SherpaDevVM/127.0.1.1:10200
16/07/14 07:26:31 INFO mapreduce.JobSubmitter: Cleaning up the staging area /tmp/hadoop-yarn/staging/root/.staging/job_1468502370759_0024
 Error: Job Failed
org.apache.hadoop.mapreduce.lib.input.InvalidInputException: Input path does not exist: hdfs://SherpaDevVM:9000/tests/in/user_queue_cluster
	at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.singleThreadedListStatus(FileInputFormat.java:323)
	at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.listStatus(FileInputFormat.java:265)
	at org.apache.hadoop.mapreduce.lib.input.FileInputFormat.getSplits(FileInputFormat.java:387)
	at org.apache.hadoop.mapreduce.JobSubmitter.writeNewSplits(JobSubmitter.java:301)
	at org.apache.hadoop.mapreduce.JobSubmitter.writeSplits(JobSubmitter.java:318)
	at org.apache.hadoop.mapreduce.JobSubmitter.submitJobInternal(JobSubmitter.java:196)
	at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1304)
	at org.apache.hadoop.mapreduce.Job$10.run(Job.java:1301)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:415)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1657)
	at org.apache.hadoop.mapreduce.Job.submit(Job.java:1301)
	at org.apache.hadoop.mapreduce.SherpaJob.waitForCompletion(SherpaJob.java:263)
	at org.apache.hadoop.mapreduce.Job.waitForCompletion(Job.java:1345)
	at org.apache.hadoop.examples.WordCount.main(WordCount.java:87)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.util.ProgramDriver$ProgramDescription.invoke(ProgramDriver.java:71)
	at org.apache.hadoop.util.ProgramDriver.run(ProgramDriver.java:144)
	at org.apache.hadoop.examples.ExampleDriver.main(ExampleDriver.java:74)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:606)
	at org.apache.hadoop.util.RunJar.run(RunJar.java:221)
	at org.apache.hadoop.util.RunJar.main(RunJar.java:136)
*** Error while getting time info (start, finish and elapsed time)
16/07/14 07:26:31 INFO utils.ConfigurationLoader: Hadoop Home: /root/cluster/hadoop/hadoop-2.7.1/
Hadoop Home: /root/cluster/hadoop/hadoop-2.7.1/
16/07/14 07:26:31 INFO utils.ConfigurationLoader: Job History Server URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs
16/07/14 07:26:31 INFO utils.ConfigurationLoader: ResourceManager URL: http://SherpaDevVM:8088/ws/v1/cluster/apps
16/07/14 07:26:31 INFO utils.ConfigurationLoader: Timeline Server URL: http://SherpaDevVM:8188/ws/v1/timeline
Properties: {pollinterval=10000, yarn.resourcemanager.webapp.address=http://SherpaDevVM:8088/ws/v1/cluster/apps, yarn.timeline-service.webapp.address=http://SherpaDevVM:8188/ws/v1/timeline, mapreduce.jobhistory.webapp.address=http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs}

Computing Latency for Job: job_1468502370759_0024


Auth type property not set, falling back to no auth ...
16/07/14 07:26:31 INFO joblauncher.SPI: SPI getJobTaskUri URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/tasks
Fetching data (counters/configs) using external program ...
Program: python /root/fetchurl.py http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/tasks


Auth type property not set, falling back to no auth ...
16/07/14 07:26:31 INFO joblauncher.SPI: SPI getJobCountersUri URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/counters
Getting job details to set queue/user info ...


Auth type property not set, falling back to no auth ...
16/07/14 07:26:31 INFO joblauncher.SPI: SPI getJobUri URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024
Fetching data (counters/configs) using external program ...
Program: python /root/fetchurl.py http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024
Done Getting Job Details ...

Error: could not get job details, queue/user info not set...

Job Meta Data: 
---------------------------------------------------
Job ID: job_1468502370759_0024
Exec Time: 0
Latency: 0
Start Time: 1969-12-31 16:00:00
Finish Time: 1969-12-31 16:00:00
Tag: NA
Compute Engine: mr
Sherpa Tuned: Yes
Job Name: word count
Job URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/counters
Cost Objective: Latency
Queue: null
User: null



Auth type property not set, falling back to no auth ...
16/07/14 07:26:31 INFO joblauncher.SPI: SPI getJobConfUri URL: http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/conf
Fetching data (counters/configs) using external program ...
Program: python /root/fetchurl.py http://SherpaDevVM:19888/ws/v1/history/mapreduce/jobs/job_1468502370759_0024/conf
Validating tuned params in allConfigs ...
All Configs Size: 0
Error: Value for java.heap.size.map not found in allConfigs ...
Error: Value for mapreduce.map.sort.spill.percent not found in allConfigs ...
Error: Value for mapreduce.reduce.shuffle.parallelcopies not found in allConfigs ...
Error: Value for mapreduce.reduce.shuffle.merge.percent not found in allConfigs ...
Error: Value for mapreduce.task.io.sort.mb not found in allConfigs ...
Error: Value for mapreduce.reduce.cpu.vcores not found in allConfigs ...
Error: Value for mapreduce.reduce.input.buffer.percent not found in allConfigs ...
Error: Value for mapreduce.map.cpu.vcores not found in allConfigs ...
Error: Value for mapreduce.map.memory.mb not found in allConfigs ...
Error: Value for java.heap.size.reduce not found in allConfigs ...
Error: Value for mapreduce.reduce.shuffle.input.buffer.percent not found in allConfigs ...
Error: Value for mapreduce.reduce.merge.inmem.threshold not found in allConfigs ...
Error: Value for mapreduce.tasktracker.indexcache.mb not found in allConfigs ...
Error: Value for mapreduce.job.reduce.slowstart.completedmaps not found in allConfigs ...
Error: Value for mapreduce.reduce.memory.mb not found in allConfigs ...
Error: Value for mapreduce.job.reduces not found in allConfigs ...
Error: Value for mapreduce.max.split.size not found in allConfigs ...


 Sending Job Report ...
Job Status?: FAILURE
JsonConfig?: {Cluster ID: sherpa	Workload ID: 9e9a510e2ca0f47309faa7b7f0ef96ff230ec6f5	State:FAILURE	Originator:Tenzing	Client Seq No:3	ML Seq No:11344	Cost:0.0	Parameters:{java.heap.size.map=68, mapreduce.map.sort.spill.percent=0.7755352881620485, mapreduce.reduce.shuffle.parallelcopies=2, mapreduce.reduce.shuffle.merge.percent=0.8835523203152067, mapreduce.task.io.sort.mb=54, mapreduce.reduce.cpu.vcores=2, mapreduce.reduce.input.buffer.percent=0.09096555132230605, mapreduce.map.cpu.vcores=1, java.heap.size.reduce=80, mapreduce.map.memory.mb=2042, mapreduce.reduce.shuffle.input.buffer.percent=0.7476920427309443, mapreduce.reduce.merge.inmem.threshold=7104, mapreduce.job.reduce.slowstart.completedmaps=0.07662748502428685, mapreduce.tasktracker.indexcache.mb=5, mapreduce.reduce.memory.mb=350, mapreduce.job.reduces=23, mapreduce.max.split.size=239399212} }
Job Configs: {java.heap.size.map=68, mapreduce.map.sort.spill.percent=0.7755352881620485, mapreduce.reduce.shuffle.parallelcopies=2, mapreduce.reduce.shuffle.merge.percent=0.8835523203152067, mapreduce.task.io.sort.mb=54, mapreduce.reduce.cpu.vcores=2, mapreduce.reduce.input.buffer.percent=0.09096555132230605, mapreduce.map.cpu.vcores=1, java.heap.size.reduce=80, mapreduce.map.memory.mb=2042, mapreduce.reduce.shuffle.input.buffer.percent=0.7476920427309443, mapreduce.reduce.merge.inmem.threshold=7104, mapreduce.job.reduce.slowstart.completedmaps=0.07662748502428685, mapreduce.tasktracker.indexcache.mb=5, mapreduce.reduce.memory.mb=350, mapreduce.job.reduces=23, mapreduce.max.split.size=239399212}

Web Proxy: Sending Job Data To CA ...
